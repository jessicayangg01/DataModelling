knitr::opts_chunk$set(echo = TRUE)
MedicalCostData <- read.csv("MedicalCost.csv")
head(MedicalCostData)
plot(MedicalCostData$age, MedicalCostData$charges, xlab = "Age", ylab = "Charges", main = "Scatterplot of Charges vs Age")
plot(MedicalCostData$age, MedicalCostData$charges, xlab = "Age", ylab = "Charges", main = "Scatterplot of Charges vs Age")
plot(MedicalCostData$bmi, MedicalCostData$charges, xlab = "BMI", ylab = "Charges", main = "Scatterplot of Charges vs BMI")
MedicalCostData$sex <- factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex <- as.numeric(MedicalCostData$sex) - 1
MedicalCostData$smoker <- factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker <- as.numeric(MedicalCostData$smoker) - 1
MedicalCostData$region <- NULL
correlations <- cor(MedicalCostData)
correlations <- cor(MedicalCostData)
knitr::opts_chunk$set(echo = TRUE)
MedicalCostData <- read.csv("MedicalCost.csv")
head(MedicalCostData)
plot(MedicalCostData$age, MedicalCostData$charges, xlab = "Age", ylab = "Charges", main = "Scatterplot of Charges vs Age")
plot(MedicalCostData$bmi, MedicalCostData$charges, xlab = "BMI", ylab = "Charges", main = "Scatterplot of Charges vs BMI")
MedicalCostData$sex <- factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex <- as.numeric(MedicalCostData$sex) - 1
MedicalCostData$smoker <- factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker <- as.numeric(MedicalCostData$smoker) - 1
MedicalCostData$region <- NULL
correlations <- cor(MedicalCostData)
MedicalCostData$sex = as.numeric(MedicalCostData$sex) - 1
MedicalCostData$smoker = as.numeric(MedicalCostData$smoker) - 1
cor_with_charges <- correlations["charges", ]
max_corr_predictor <- names(cor_with_charges[which.max(abs(cor_with_charges))])
min_corr_predictor <- names(cor_with_charges[which.min(abs(cor_with_charges))])
MedicalCostData <- read.csv("MedicalCost.csv")
head(MedicalCostData)
plot(MedicalCostData$age, MedicalCostData$charges, xlab = "Age", ylab = "Charges", main = "Scatterplot of Charges vs Age")
plot(MedicalCostData$bmi, MedicalCostData$charges, xlab = "BMI", ylab = "Charges", main = "Scatterplot of Charges vs BMI")
MedicalCostData$sex <- factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex <- as.numeric(MedicalCostData$sex) - 1
MedicalCostData$smoker <- factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker <- as.numeric(MedicalCostData$smoker) - 1
MedicalCostData$region <- NULL
correlations <- cor(MedicalCostData)
MedicalCostData$sex = as.numeric(MedicalCostData$sex) - 1
MedicalCostData$smoker = as.numeric(MedicalCostData$smoker) - 1
cor_with_charges <- correlations["charges", ]
max_corr_predictor <- names(cor_with_charges[which.max(abs(cor_with_charges))])
min_corr_predictor <- names(cor_with_charges[which.min(abs(cor_with_charges))])
MedicalCostData = read.csv("MedicalCost.csv")
head(MedicalCostData)
plot(MedicalCostData$bmi, MedicalCostData$charges, xlab = "BMI", ylab = "Charges", main = "Scatterplot of Charges vs Age")
plot(MedicalCostData$age, MedicalCostData$charges, xlab = "Age", ylab = "Charges", main = "Scatterplot of Charges vs Age")
MedicalCostData$sex = factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex = as.numeric(MedicalCostData$sex) - 1
MedicalCostData$sex = factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex = as.numeric(MedicalCostData$sex) - 1
head(MedicalCostData)
MedicalCostData$sex = factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex = as.numeric(MedicalCostData$sex) - 1
print(MedicalCostData)
MedicalCostData$sex = factor(MedicalCostData$sex, levels = c("male", "female"))
print(MedicalCostData$sex)
MedicalCostData$sex = as.numeric(MedicalCostData$sex) - 1
print(MedicalCostData)
MedicalCostData$sex = factor(MedicalCostData$sex)
print(MedicalCostData$sex)
MedicalCostData$sex = as.numeric(MedicalCostData$sex) - 1
print(MedicalCostData)
sex = factor(MedicalCostData$sex)
print(MedicalCostData$sex)
MedicalCostData$sex = as.numeric(sex - 1
print(MedicalCostData)
sex = factor(MedicalCostData$sex)
print(sex)
MedicalCostData$sex = as.numeric(sex - 1
print(MedicalCostData)
sex = factor(MedicalCostData$sex)
print(sex)
MedicalCostData$sex = as.numeric(sex - 1
MedicalCostData = read.csv("MedicalCost.csv")
sex = factor(MedicalCostData$sex)
MedicalCostData$sex = as.numeric(sex) - 1
head(MedicalCostData)
MedicalCostData = read.csv("MedicalCost.csv")
sex = factor(MedicalCostData$sex, levels = c("male", "female")
MedicalCostData$sex = as.numeric(sex) - 1
sex = factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex = as.numeric(sex) - 1
head(MedicalCostData)
MedicalCostData$smoker <- factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker <- as.numeric(MedicalCostData$smoker) - 1
MedicalCostData$smoker <- factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker <- as.numeric(MedicalCostData$smoker) - 1
head(MedicalCostData)
smoker = factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker = as.numeric(MedicalCostData$smoker) - 1
head(MedicalCostData)
smoker = factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker = as.numeric(smoker) - 1
head(MedicalCostData)
MedicalCostData = read.csv("MedicalCost.csv")
sex = factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex = as.numeric(sex) - 1
head(MedicalCostData)
smoker = factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker = as.numeric(smoker) - 1
head(MedicalCostData)
MedicalCostData$region <- NULL
head(MedicalCostData)
correlations <- cor(MedicalCostData)
head(correlations)
correlations <- cor(MedicalCostData)
head(correlations)
correlations <- cor(MedicalCostData)
print(correlations)
MedicalCostData = read.csv("MedicalCost.csv")
head(MedicalCostData)
plot(MedicalCostData$age, MedicalCostData$charges, xlab = "Age", ylab = "Charges", main = "Scatterplot of Charges vs Age")
plot(MedicalCostData$bmi, MedicalCostData$charges, xlab = "BMI", ylab = "Charges", main = "Scatterplot of Charges vs BMI")
sex = factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex = as.numeric(sex) - 1
head(MedicalCostData)
smoker = factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker = as.numeric(smoker) - 1
head(MedicalCostData)
MedicalCostData$region <- NULL
head(MedicalCostData)
correlations <- cor(MedicalCostData)
print(correlations)
MedicalCostData = read.csv("MedicalCost.csv")
head(MedicalCostData)
MedicalCostData = read.csv("MedicalCost.csv")
head(MedicalCostData)
model <- lm(charges ~ ., data = medical_data)
model <- lm(charges ~ ., data = MedicalCostData)
model <- lm(charges ~ ., data = MedicalCostData)
head(model)
summary(model)
MedicalCostData = read.csv("MedicalCost.csv")
head(MedicalCostData)
plot(MedicalCostData$age, MedicalCostData$charges, xlab = "Age", ylab = "Charges", main = "Scatterplot of Charges vs Age")
plot(MedicalCostData$bmi, MedicalCostData$charges, xlab = "BMI", ylab = "Charges", main = "Scatterplot of Charges vs BMI")
sex = factor(MedicalCostData$sex, levels = c("male", "female"))
MedicalCostData$sex = as.numeric(sex) - 1
head(MedicalCostData)
smoker = factor(MedicalCostData$smoker, levels = c("no", "yes"))
MedicalCostData$smoker = as.numeric(smoker) - 1
head(MedicalCostData)
MedicalCostData$region <- NULL
head(MedicalCostData)
correlations <- cor(MedicalCostData)
print(correlations)
model <- lm(charges ~ ., data = MedicalCostData)
summary(model)
model_no_sex <- lm(charges ~ age + bmi + children + smoker, data = MedicalCostData)
summary(model_no_sex)
set.seed(123)  # for reproducibility
sample_index <- sample(seq_len(nrow(MedicalCostData), size = 0.8 * nrow(MedicalCostData))
TrainingSet <- MedicalCostData[sample_index, ]
set.seed(123)  # for reproducibility
sample_index = sample(seq_len(nrow(MedicalCostData), size = 0.8 * nrow(MedicalCostData)))
set.seed(123)  # for reproducibility
sample_index = sample(seq_len(nrow(MedicalCostData), size = 0.8 * nrow(MedicalCostData)))
set.seed(123)  # for reproducibility
sample_index = sample(seq_len(nrow(MedicalCostData)), size = 0.8 * nrow(MedicalCostData))
TrainingSet = MedicalCostData[sample_index, ]
TestingSet = MedicalCostData[-sample_index, ]
model_no_sex_train <- lm(charges ~ age + bmi + children + smoker, data = TrainingSet)
model_no_sex_train <- lm(charges ~ age + bmi + children + smoker, data = TrainingSet)
summary(model_no_sex_train)
predictions_test <- predict(model_no_sex_train, newdata = TestingSet)
predictions_test = predict(model_no_sex_train, newdata = TestingSet)
predictions_test = predict(model_no_sex_train, newdata = TestingSet)
summary(predictions_test)
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
summary(rmse)
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
rmse
predictions_test = predict(model_no_sex_train, newdata = TestingSet)
predictions_test
predictions_test = predict(model_no_sex_train, newdata = TestingSet)
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
rmse
install.packages("forecast")
actual_values <- TrainingSet
predicted_values <- TestingSet
mape_score <- mape(actual_values, predicted_values)
mape <- function(actual, predicted) {
if (length(actual) != length(predicted)) {
stop("Lengths of actual and predicted vectors must be the same.")
}
N <- length(actual)
mape_value <- sum(abs((predicted - actual) / actual)) / N * 100
return(mape_value)
}
actual_values <- TrainingSet
predicted_values <- TestingSet
mape_score <- mape(actual_values, predicted_values)
mape <- function(actual, predicted) {
if (length(actual) != length(predicted)) {
stop("Lengths of actual and predicted vectors must be the same.")
}
N <- length(actual)
mape_value <- sum(abs((predicted - actual) / actual)) / N * 100
return(mape_value)
}
actual_values <- TrainingSet
predicted_values <- predictions_test
mape_score <- mape(actual_values, predicted_values)
mape <- function(actual, predicted) {
if (length(actual) != length(predicted)) {
stop("Lengths of actual and predicted vectors must be the same.")
}
N <- length(actual)
mape_value <- sum(abs((predicted - actual) / actual)) / N * 100
return(mape_value)
}
actual_values <- TestingSet
predicted_values <- predictions_test
mape_score <- mape(actual_values, predicted_values)
mape <- function(actual, predicted) {
if (length(actual) != length(predicted)) {
stop("Lengths of actual and predicted vectors must be the same.")
}
N <- length(actual)
mape_value <- sum(abs((predicted - actual) / actual)) / N * 100
return(mape_value)
}
actual_values <- TestingSet$charges
predicted_values <- predictions_test
mape_score <- mape(actual_values, predicted_values)
cat("MAPE:", mape_score, "%")
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
rmse
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
rmse
charge_range <- range(MedicalCostData$charges)
cat("Range of charges: ", charge_range[1], " to ", charge_range[2])
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
cat("The RMSE is: ", rmse)
charge_range <- range(MedicalCostData$charges)
cat("Range of charges: ", charge_range[1], " to ", charge_range[2])
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
cat("The RMSE is: ", rmse)
charge_range <- range(MedicalCostData$charges)
cat("/nRange of charges: ", charge_range[1], " to ", charge_range[2])
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
cat("The RMSE is: ", rmse)
charge_range <- range(MedicalCostData$charges)
cat(/n,"Range of charges: ", charge_range[1], " to ", charge_range[2])
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
cat("The RMSE is: ", rmse)
charge_range <- range(MedicalCostData$charges)
cat("\nRange of charges: ", charge_range[1], " to ", charge_range[2])
rmse <- sqrt(mean((TestingSet$charges - predictions_test)^2))
cat("The RMSE is: ", rmse)
charge_range <- range(MedicalCostData$charges)
cat("\nRange of charges: ", charge_range[1], " to ", charge_range[2])
